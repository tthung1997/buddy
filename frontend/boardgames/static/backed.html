<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <link rel="stylesheet" href="/static/style.css">
    <title>Boardgames Tracker</title>
</head>
<body>
    <div class="container wide-container">
        <h1>Backed / Preordered Boardgames Tracker</h1>
        <a href="/boardgames" class="button-link">Boardgames</a>
        {{if .Error}}
        <p><span class="error">Error: {{.Error}}</span></p>
        {{end}}
        {{if .Success}}
        <p><span class="success">{{.Success}}</span></p>
        {{end}}
        <form class="add-form" method="POST" action="{{if .AddName}}/boardgames/backed/edit{{else}}/boardgames/backed/add{{end}}" style="margin-bottom: 24px;">
            <input type="hidden" name="idx" value="{{if .AddName}}{{range $i, $game := .Items}}{{if eq $game.Name $.AddName}}{{$i}}{{end}}{{end}}{{end}}">
            <div style="display: flex; flex-wrap: wrap; gap: 16px; align-items: flex-start;">
                <div style="display: flex; flex-direction: column;">
                    <label for="name">Name</label>
                        <input type="text" id="name" name="name" required value="{{.AddName}}" class="form-input">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="delivery">Expected Delivery</label>
                        <input type="month" id="delivery" name="delivery" required value="{{if .AddName}}{{range .Items}}{{if eq .Name $.AddName}}{{.Delivery}}{{end}}{{end}}{{end}}" class="form-input">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="price">Price Paid</label>
                        <input type="number" id="price" name="price" required value="{{if .AddName}}{{range .Items}}{{if eq .Name $.AddName}}{{.PricePaid}}{{end}}{{end}}{{end}}" class="form-input">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="from">Backed/Preordered From</label>
                        <input type="text" id="from" name="from" required value="{{if .AddName}}{{range .Items}}{{if eq .Name $.AddName}}{{.From}}{{end}}{{end}}{{end}}" class="form-input">
                </div>
                <div style="display: flex; flex-direction: column;">
                    <label for="platform">Pledge Manager Platform</label>
                        <input type="text" id="platform" name="platform" value="{{if .AddName}}{{range .Items}}{{if eq .Name $.AddName}}{{.Platform}}{{end}}{{end}}{{end}}" class="form-input">
                </div>
                <div style="display: flex; flex-direction: column; justify-content: flex-end; height: 100%;">
                    <button type="submit" style="margin-top: 22px;">{{if .AddName}}Save Changes{{else}}Add Boardgame{{end}}</button>
                </div>
            </div>
        </form>
            <div class="table-responsive">
                <table id="collectionTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Expected Delivery</th>
                            <th style="text-align: center;">Price Paid</th>
                            <th>Backed/Preordered From</th>
                            <th>Pledge Manager Platform</th>
                            <th style="text-align: center;">Received</th>
                            <th style="text-align: center;">Edit</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range $i, $game := .Items}}
                        <tr {{if $game.Received}}class="received"{{end}}>
                            <td>{{$game.Name}}</td>
                            <td>{{$game.Delivery}}</td>
                            <td style="text-align: center;">{{$game.PricePaid}}</td>
                            <td>{{$game.From}}</td>
                            <td>{{$game.Platform}}</td>
                            <td style="text-align: center;">{{if $game.Received}}âœ…{{else}}<form method="POST" action="/boardgames/backed/receive" style="display:inline;"><input type="hidden" name="idx" value="{{$i}}"><button type="submit">Mark Received</button></form>{{end}}</td>
                            <td style="text-align: center;"><a href="/boardgames/backed/edit?idx={{$i}}" class="button-link">Edit</a></td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
    </div>
</body>
</html>
